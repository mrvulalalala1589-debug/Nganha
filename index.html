<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Awaken The Universe</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{
  margin:0;
  overflow:hidden;
  background:#000;
  touch-action:none;
}
#hint{
  position:fixed;
  top:12px;
  left:50%;
  transform:translateX(-50%);
  color:#9ff;
  font-size:14px;
  opacity:.85;
  z-index:10;
  font-family:Arial;
  pointer-events:none;
  transition:.6s;
}
canvas{display:block}
</style>
</head>
<body>
<div id="hint">üå† Ng∆∞·ªõc nh√¨n b·∫ßu tr·ªùi ‚Äì ch·∫°m ƒë·ªÉ ƒë√°nh th·ª©c v≈© tr·ª•</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
/* ================= BASIC ================= */
const scene = new THREE.Scene();
scene.fog = new THREE.FogExp2(0x040014,0.0007);

const camera = new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,3000);
camera.position.set(0,-40,130);
camera.lookAt(0,40,0);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

/* ================= LIGHT ================= */
scene.add(new THREE.AmbientLight(0x8899ff,.4));
const light = new THREE.PointLight(0xaabbff,1.8,800);
light.position.set(0,120,200);
scene.add(light);

/* ================= STAR TEXTURE ================= */
function glowTexture(){
  const c=document.createElement('canvas');
  c.width=c.height=64;
  const ctx=c.getContext('2d');
  const g=ctx.createRadialGradient(32,32,0,32,32,32);
  g.addColorStop(0,'rgba(255,255,255,1)');
  g.addColorStop(.3,'rgba(160,180,255,.8)');
  g.addColorStop(.6,'rgba(100,100,255,.25)');
  g.addColorStop(1,'rgba(0,0,0,0)');
  ctx.fillStyle=g;
  ctx.fillRect(0,0,64,64);
  return new THREE.CanvasTexture(c);
}
const starTex = glowTexture();

/* ================= OPENING SKY ================= */
const starGeo = new THREE.BufferGeometry();
const starCount = 8000;
const pos = new Float32Array(starCount*3);

for(let i=0;i<starCount;i++){
  const r = Math.random()*900;
  const a = Math.random()*Math.PI*2;
  pos[i*3]=Math.cos(a)*r;
  pos[i*3+1]=Math.random()*400;
  pos[i*3+2]=Math.sin(a)*r;
}
starGeo.setAttribute('position',new THREE.BufferAttribute(pos,3));

const stars = new THREE.Points(
  starGeo,
  new THREE.PointsMaterial({
    size:3,
    map:starTex,
    transparent:true,
    depthWrite:false,
    blending:THREE.AdditiveBlending
  })
);
scene.add(stars);

/* ================= METEORS ================= */
const meteors=[];
function createMeteor(){
  const g=new THREE.BufferGeometry().setFromPoints([
    new THREE.Vector3(0,0,0),
    new THREE.Vector3(-25,-8,-50)
  ]);
  const m=new THREE.Line(
    g,
    new THREE.LineBasicMaterial({color:0xffffff,opacity:.9,transparent:true})
  );
  m.position.set(Math.random()*400-200,300+Math.random()*150,-200);
  m.userData.speed=.5+Math.random();
  scene.add(m);
  meteors.push(m);
}
for(let i=0;i<16;i++) createMeteor();

/* ================= CLOUD ================= */
const clouds=[];
for(let i=0;i<3;i++){
  const c=new THREE.Mesh(
    new THREE.PlaneGeometry(1000,300),
    new THREE.MeshBasicMaterial({color:0x332255,transparent:true,opacity:.15})
  );
  c.position.set(0,60+i*18,-300-i*80);
  scene.add(c);
  clouds.push(c);
}

/* ================= GROUND ================= */
const ground=new THREE.Mesh(
  new THREE.PlaneGeometry(1500,400),
  new THREE.MeshBasicMaterial({color:0x000000})
);
ground.position.set(0,-80,-150);
scene.add(ground);

/* ================= UNIVERSE CORE ================= */
let awakened=false;
const galaxy=new THREE.Group();
galaxy.visible=false;
scene.add(galaxy);

/* ===== Spiral Galaxy ===== */
const spiralGeo=new THREE.BufferGeometry();
const spiralCount=6000;
const spiralPos=new Float32Array(spiralCount*3);

for(let i=0;i<spiralCount;i++){
  const t=i/spiralCount*20;
  const r=6*t;
  spiralPos[i*3]=Math.cos(t)*r+(Math.random()-.5)*4;
  spiralPos[i*3+1]=(Math.random()-.5)*10;
  spiralPos[i*3+2]=Math.sin(t)*r+(Math.random()-.5)*4;
}
spiralGeo.setAttribute('position',new THREE.BufferAttribute(spiralPos,3));

const spiral=new THREE.Points(
  spiralGeo,
  new THREE.PointsMaterial({
    size:2.4,
    map:starTex,
    transparent:true,
    blending:THREE.AdditiveBlending
  })
);
galaxy.add(spiral);

/* ===== Floating Images ===== */
const imgUrls=[
  "https://images.unsplash.com/photo-1446776811953-b23d57bd21aa",
  "https://images.unsplash.com/photo-1462331940025-496dfbfc7564",
  "https://images.unsplash.com/photo-1473929734674-6b3c85a87f5f",
  "https://images.unsplash.com/photo-1444703686981-a3abbc4d4fe3"
];

const loader=new THREE.TextureLoader();
const images=[];
imgUrls.forEach((u,i)=>{
  const m=new THREE.Mesh(
    new THREE.PlaneGeometry(18,12),
    new THREE.MeshBasicMaterial({
      map:loader.load(u),
      transparent:true,
      opacity:0
    })
  );
  m.userData={
    angle:Math.random()*Math.PI*2,
    radius:40+Math.random()*30,
    speed:.001+Math.random()*.001
  };
  galaxy.add(m);
  images.push(m);
});

/* ================= INTERACTION ================= */
let dragging=false,lastX=0,lastY=0;
let rotX=0,rotY=0,zoom=1;

addEventListener('pointerdown',e=>{
  dragging=true;lastX=e.clientX;lastY=e.clientY;
  if(!awakened) awaken();
});
addEventListener('pointerup',()=>dragging=false);
addEventListener('pointermove',e=>{
  if(!dragging) return;
  rotY+=(e.clientX-lastX)*0.002;
  rotX+=(e.clientY-lastY)*0.002;
  lastX=e.clientX;lastY=e.clientY;
});
addEventListener('wheel',e=>{
  zoom+=e.deltaY*0.0005;
  zoom=Math.max(.6,Math.min(1.6,zoom));
});

/* ================= AWAKEN ================= */
function awaken(){
  awakened=true;
  galaxy.visible=true;
  document.getElementById('hint').style.opacity=0;
  images.forEach((img,i)=>{
    setTimeout(()=>img.material.opacity=1,600+i*300);
  });
}

/* ================= ANIMATE ================= */
function animate(){
  requestAnimationFrame(animate);

  stars.rotation.y+=0.00015;

  meteors.forEach(m=>{
    m.position.x-=m.userData.speed*1.6;
    m.position.y-=m.userData.speed;
    m.position.z-=m.userData.speed*2;
    if(m.position.y<-60){
      m.position.set(Math.random()*400-200,320,-200);
    }
  });

  clouds.forEach((c,i)=>{
    c.position.x+=0.04*(i+1);
    if(c.position.x>300) c.position.x=-300;
  });

  if(awakened){
    galaxy.rotation.y+=0.0015;
    galaxy.rotation.x+=0.0005;
    galaxy.rotation.y+=rotY*0.05;
    galaxy.rotation.x+=rotX*0.05;
    galaxy.scale.setScalar(zoom);

    images.forEach(img=>{
      img.userData.angle+=img.userData.speed;
      img.position.set(
        Math.cos(img.userData.angle)*img.userData.radius,
        Math.sin(img.userData.angle*1.5)*12,
        Math.sin(img.userData.angle)*img.userData.radius
      );
      img.lookAt(camera.position);
    });

    rotX*=.9; rotY*=.9;
  }

  renderer.render(scene,camera);
}
animate();

/* ================= RESIZE ================= */
addEventListener('resize',()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
